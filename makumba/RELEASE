RELEASE HOWTO
=============

PREREQUISITES
-------------

- gpg installed on your system so that the maven gpg plugin can use it
- the makumba public & private keys imported on your system
- don't use maven 2.2.0 since it contains a bug and generates invalid checksums

- Sonatype user and password must be configured in ~.m2/settings.xml:

<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0
                      http://maven.apache.org/xsd/settings-1.0.0.xsd">

  <servers>
    <server>
      <id>sonatype-nexus-snapshots</id>
      <username>USER</username>
      <password>PASSWORD</password>
    </server>
    <server>
      <id>sonatype-nexus-staging</id>
      <username>USER</username>
      <password>PASSWORD</password>
    </server>
  </servers>
</settings>

- Sourceforge username & password configured in build.properties

COMMANDS
--------

=== deploying a snapshot on the sonatype server

mvn clean deploy

=== uploading the current artifacts to sourceforge

This will upload the artifacts with the version number of the POM to sourceforge.
For the moment, this only works for makumba-core.

- open a connection to the FRS (or the upload will fail)

  ssh -t <SF user>,makumba@shell.sourceforge.net create

- run the upload

  mvn wagon:upload -Dusername=<SF user> -Dpassword=<SF password>

=== releasing a version

This will
- create a new tag in SVN for the current version
- update all POMs to the next development version
- create artifacts and deploy them on Sonatype (where they might be synced with central)
- upload the new artifacts to Sourceforge

/!\ do not forget to set your username & password in build.properties or the release will fail at the end

/!\ make sure you have the right version number in the artifacts you want to deploy

mvn release:prepare -Dusername=<SF user> -Dpassword=<SF password>

(in a separate terminal) ssh -t <SF user>,makumba@shell.sourceforge.net create

mvn release:perform -Darguments="-Dgpg.passphrase=<makumba passphrase> -Dgpg.keyname=makumba-devel@lists.sourceforge.net"