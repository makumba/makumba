<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE document PUBLIC "-//MAKUMBA//DTD Documentation V2.0//EN" "document-v20-mak.dtd">
<document>
    <header>
        <title>Makumba web-app configuration</title>
    </header>
    <body>
        <p>This page explains how a web-app should be configured in order to work properly with Makumba.</p>
        <section>
            <title>Makumba controller filter mapping</title>
            <p>In order to work properly, the following filter should be mapped in <code>WEB-INF/web.xml</code>:</p>
                <source>
                    <![CDATA[ 
            <filter>
                <filter-name>makumba_controller</filter-name>
                <filter-class>org.makumba.controller.http.ControllerFilter</filter-class>
            </filter>
            
            <filter-mapping>
                <filter-name>makumba_controller</filter-name>
                <url-pattern>*.jsp</url-pattern>
            </filter-mapping>
            <filter-mapping>
                <filter-name>makumba_controller</filter-name>
                <url-pattern>*.jspx</url-pattern>
            </filter-mapping>
            <filter-mapping>
                <filter-name>makumba_controller</filter-name>
                <url-pattern>/mak-tools</url-pattern>
            </filter-mapping>
            <filter-mapping>
                <filter-name>makumba_controller</filter-name>
                <url-pattern>/mak-tools/*</url-pattern>
            </filter-mapping> ]]>
                </source>
            <p>The mappings are needed for the following reasons:</p>
            <ul>
                <li>*.jsp: to enable authentication/authorisation on JSP page access, and to enable form processing</li>
                <li>*.jspx: to enable the source-code viewer for JSP files</li>
                <li>/mak-tools/ and /mak-tools/*: to enable the various makumba tools, such as the MDD viewer.</li>
            </ul>
            <note>The <code>/mak-tools</code> path can be configured in <code>Makumba.conf</code>, see the <a href="/configuration/configuration.html#makToolsPath">Makumba tools path configuration</a></note>
        </section>
        
        <section>
            <title>Custom error handling</title>
            
            <p>By default, Makumba throws errors using its internal layout.
            To enable the custom error for some pages of your application, you only
            need to create an <code>error.jsp</code> file in the root folder of your web-app and it will be used for all
            subfolders.</p>
            <p>If you want a different error message for specific
            pages, these will need to be in their own folder and you will need to
            put a different <code>error.jsp</code> file in that folder. In other words, Makumba
            searches for <code>error.jsp</code> starting from the folder of the page that
            caused the error and going to all the parent folders until it finds it or
            reaches the root of application in which case it shows the default
            error page.
            </p>
            
            <section>
                <title>Content of error.jsp</title>
            </section>
            <p>
            It is advised to use a simple HTML document as error.jsp, or to minimize the additional code (Makumba, JSTL, etc.).</p>
            <p>There are 3 attributes that should be placed somewhere in the page to get the error information:</p>
            
            <ul>
                <li><strong>mak_error_title</strong> - gives the title of the error</li>
                <li><strong>mak_error_description</strong> - gives the error description which is normally the content of the default error page</li>
                <li><strong>mak_error_realpath</strong> - gives you the path to the file that caused the error</li>
            </ul>
            
            
        </section>
        
    </body>
</document>
